{% extends 'base.html' %}

{% block content %}
<div class="status-container">
    <h2>Emergency Status</h2>

    <div class="alert-card">
        <h3>{{ alert.emergency_type|default:"General Emergency" }}</h3>
        <p>Reported: {{ alert.timestamp }}</p>
        <p>Status: <strong>{{ alert.get_status_display }}</strong></p>

        {% if alert.assigned_responder %}
        <div class="responder-info">
            <h4>Assigned Responder:</h4>
            <p>{{ alert.assigned_responder.user.get_full_name }}</p>
            <p>{{ alert.assigned_responder.organization }}</p>
            <p>{{ alert.assigned_responder.contact_number }}</p>
        </div>
        {% endif %}
    </div>

    {% if request.user == alert.assigned_responder.user %}
    <form method="post" class="status-update-form">
        {% csrf_token %}
        <label>Update Status:</label>
        <select name="status">
            {% for value, name in alert.STATUS_CHOICES %}
            <option value="{{ value }}" {% if alert.status==value %}selected{% endif %}>{{ name }}</option>
            {% endfor %}
        </select>
        <button type="submit" class="btn btn-primary">Update</button>
    </form>
    {% endif %}
</div>
{% endblock %}